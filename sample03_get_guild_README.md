# Discord サーバーメンバー取得ボット

Discordサーバーの全メンバー情報を取得し、詳細な統計付きテキストファイルとしてダウンロード可能にするボットです。

## 機能概要

### 👁️ メンバー一覧取得
- **トリガー**: 任意のメッセージに👁️リアクションを付ける
- **対象**: そのチャンネルが所属するサーバー全体
- **動作**: 全メンバー情報を収集してファイル化

### 📊 取得情報
- **基本情報**: ユーザー名・表示名・ユーザーID
- **日時情報**: アカウント作成日・サーバー参加日
- **ステータス**: オンライン状況・BOT判定
- **ロール情報**: 所持ロール・最高ロール
- **その他**: ブースト状況・アバターURL

### 📈 統計機能
- **総メンバー数**: 人間・BOT・ブースター別集計
- **ロール統計**: ロール別人数ランキング

## ファイル構成

### 生成されるファイル
```
guild_{サーバーID}_members_{YYYYMMDD_HHMMSS}.txt
```

### ファイル形式例
```
=== ServerName サーバーメンバー一覧 ===
取得日時: 2025年01月20日 17時30分45秒
総メンバー数: 150人
サーバーID: 1234567890123456789
================================================================================

【0001】 UserName#1234
  表示名: DisplayName
  ユーザーID: 987654321098765432
  アカウント作成日: 2020-01-15 10:30:25
  サーバー参加日: 2023-03-20 14:45:10
  ステータス: online
  BOT: いいえ
  最高ロール: Admin
  所持ロール: Admin, Member, Special
  ブースト状況: 2024-01-01 12:00:00
------------------------------------------------------------

=== 統計情報 ===
総メンバー数: 150人
人間: 135人
BOT: 15人
ブースター: 12人

=== ロール統計 ===
Member: 140人
VIP: 25人
Moderator: 8人
Admin: 3人
```

## 使用方法

### 1. スタンドアロン実行
```bash
cd /Users/suguruhirayama/Desktop/AI実験室/Discordbot
python sample03_get_guild.py
```

### 2. Discord上での操作

#### メンバー一覧取得
1. 任意のチャンネルで任意のメッセージに👁️を付ける
2. ボットがメンバー情報収集を開始
3. 完了後、ファイルがアップロードされる

#### コマンド
- `!memberinfo`: メンバー取得機能の説明
- `!serverstats`: サーバーの基本統計情報

## 特徴

### ✅ メリット
- **全メンバー対応**: サーバーの全メンバーを漏れなく取得
- **詳細情報**: 豊富なメンバー情報と統計データ
- **レート制限対応**: 100人ごとに1秒待機で安全取得
- **重複防止**: 収集中は追加実行をブロック

### ⚠️ 注意事項
- **時間要**: メンバー数が多いと数分かかる場合があります
- **権限必要**: BOTにメンバー情報読み取り権限が必要
- **ファイルサイズ**: 8MBを超えるとDiscordアップロード不可
- **プライバシー**: メンバー情報の取り扱いに注意

## 対応リアクション

### 👁️ 基本の目玉
- `👁️` (基本の目玉)
- `👀` (両目)
- `🔍` (虫眼鏡)
- `👁‍🗨` (目と吹き出し)

## パフォーマンス

### 処理時間目安
- **~100人**: 約10-20秒
- **~500人**: 約1-2分  
- **~1000人**: 約3-5分
- **1000人以上**: 5分以上

### メモリ使用量
- **メンバー1人あたり**: 約1-2KB
- **1000人サーバー**: 約1-2MB

## トラブルシューティング

### メンバー情報が取得できない
- ボットにメンバー読み取り権限があるか確認
- サーバーのメンバー情報が公開設定になっているか確認

### ファイルがアップロードされない
- ファイルサイズが8MB以下か確認
- ボットがファイル送信権限を持っているか確認

### 収集が途中で止まる
- ネットワーク接続を確認
- Discordのレート制限の可能性（時間をおいて再実行）

## セキュリティ

### 取得情報の範囲
- **公開情報のみ**: Discordで公開されている情報のみ取得
- **DM不可**: プライベートメッセージは取得不可
- **サーバー限定**: 対象サーバーのメンバーのみ

### データ保護
- **ローカル保存**: ファイルはローカルに保存
- **一時的**: ダウンロード後は削除推奨
- **暗号化なし**: 機密情報として取り扱い要

## 環境変数

`.env`ファイルに以下を設定：
```
DISCORD_TOKEN=your_discord_bot_token_here
```

## 必要な権限

Discord Application で以下の権限が必要：
- `Read Messages`
- `Send Messages` 
- `Read Message History`
- `Add Reactions`
- `Attach Files`
- `View Server Members` ⭐ 重要
- `Read Server Member Data` ⭐ 重要