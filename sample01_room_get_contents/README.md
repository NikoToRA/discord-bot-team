# Room Log Collector

Discordチャンネルのメッセージログを収集し、テキストファイル化するプログラムです。

## 機能

### 📋 ログ収集機能
- **トリガー**: 任意のメッセージにサムズアップ（👍）リアクションを付ける
- **動作**: そのチャンネルのすべてのメッセージを収集
- **制限**: 100件ごとに2秒スリープ（レート制限対策）

### 📁 ファイル出力
- **形式**: UTF-8 テキストファイル
- **命名**: `{チャンネル名}_log_{YYYYMMDD_HHMMSS}.txt`
- **保存場所**: `/Users/suguruhirayama/Desktop/AI実験室/Discordbot/sample01_room_get_contents/`

### 📤 Discord統合
- **8MB以下**: Discordにファイルをアップロード（ダウンロード可能）
- **8MB以上**: ローカル保存のみ（パス表示）

## 使用方法

### スタンドアロン実行
```bash
cd /Users/suguruhirayama/Desktop/AI実験室/Discordbot/sample01_room_get_contents
python room_log_collector.py
```

### Discord上での操作
1. ログを取得したいチャンネルで任意のメッセージにサムズアップ👍を付ける
2. ボットが「ログ収集を開始します」とメッセージを送信
3. 収集完了後、テキストファイルがアップロードされる

### コマンド
- `!loginfo`: ログ収集機能の詳細情報を表示

## ログファイル形式

```
=== room1 チャンネルログ ===
収集日時: 2025年01月20日 15時30分45秒
総メッセージ数: 150件
==================================================

[2025-01-15 10:30:15] UserName#1234
内容: こんにちは！
メッセージID: 1234567890123456789
------------------------------

[2025-01-15 10:31:20] AnotherUser#5678
内容: 画像を投稿しました
添付ファイル: https://cdn.discordapp.com/attachments/...
リアクション: 👍(3), ❤️(1)
メッセージID: 9876543210987654321
------------------------------
```

## 注意事項

- **権限**: ボットがチャンネルの履歴読み取り権限を持っている必要があります
- **レート制限**: Discord APIの制限に配慮して100件ごとに2秒待機します
- **ファイルサイズ**: 8MBを超える場合はDiscordにアップロードできません
- **同時実行**: 1つのチャンネルのログ収集中は他の収集要求をブロックします

## 環境変数

`.env`ファイルに以下を設定：
```
DISCORD_TOKEN=your_discord_bot_token_here
```

## 必要な権限

Discord Application で以下の権限が必要：
- `Read Messages`
- `Send Messages`
- `Read Message History`
- `Add Reactions`
- `Attach Files`